入门示例2
=========

这一节将在上一节的基础上介绍使用GMT的结构化做图思想，并用 ``psxy`` 和 ``pstext`` 模块绘制一副射线路径图。

GMT结构化的做图
---------
其实，GMT所作出的图是postscript的文本文件，可以用gedit、记事本这样的文本编辑器打开。GMT做图的实质是将用户输入的GMT命令转化为postscript语句。postscript是面向机器的语言，不是给人读的，所以不必去尝试读懂postscirpt语句。

在实际做图时，一副完整的图画是由很多的部分组成的。如果一条GMT命令只绘制一个部分，想修改这部分时，就只需修改该部分的命令即可，而不会影响其他部分。这就是结构化的作图。一个完整的postscript文本是由文件头、文件内容和文件尾组成的。如果不加特别操作，每一条GMT命令都会生成一个完整的postscript文件的三个部分。那么如何让第一条命令不生成文件头，中间的命令不生成文件头和文件尾，最后一条命令不生成文件头呢？有-K和-O选项。当命令包含-K时，不会生成文件尾。当命令包含-O时，不会生成文件头。

下面我们就实际画一幅图，一方面学习具体的做图步骤，一方面介绍重要的GMT模块 ``psxy`` 和 ``pstext`` 。

绘制底图
---------

.. literalinclude:: ../scripts/GMT_tutor2_1.sh
   :language: bash
   :lines: 2


.. figure:: /images/GMT_tutor2_1.*
   :width: 500 px
   :align: center

解释一下：

1. -K表示不写入文件尾，-O表示不要文件头

2. >表示生成新文件，>>表示在文件中追加内容

3. -T表示空输入，什么都不画


psxy模块绘制五角星和三角形
---------
我们一般用五角星表示震中，三角形表示台站。五角星和三角形这样的图案用psxy模块绘制，见下面的代码和结果：

.. literalinclude:: ../scripts/GMT_tutor2_2.sh
   :language: bash
   :lines: 2


.. figure:: /images/GMT_tutor2_2.*
   :width: 500 px
   :align: center

解释psxy模块相关的命令：

1. -J和-R与前面一样是指投影和范围。

2. -S表示绘图的图形，后面跟t表示三角形，a表示五角星，0.2c表示外接圆的直径是0.2厘米；-St0.2c就是画一个三角形，外接圆直径是0.2厘米；-Sa0.5c表示绘制一个五角星，外接圆的直径0.5厘米。

3. -W表示画笔的属性；-S选项确定了画一个多大的三角形，但是用什么画笔还不清楚。-W0.5p,black,solid的意思是画笔0.5p宽，黑色，实心。

4. -G表示颜色填充，后面跟颜色的名字；-Gblack表示填充黑色；-Gyellow表示填充黄色。

5. 确定了画什么样的图形，还要确定在哪里画。EOF之间的就是位置信息，一行代表一个位置。默认情况下，GMT认为第一个数是经度，第二个是纬度。如果像这里的代码，加了-: 就表示先是纬度，后是经度了。

psxy模块绘制线条
---------
psxy模块除了绘制图形，也绘制线条。下面我们用psxy给图画加上射线路径。psxy会自动使用大圆路径，不需要额外设置。首先直接看代码：

.. literalinclude:: ../scripts/GMT_tutor2_3.sh
      :language: bash
   :lines: 2


.. figure:: /images/GMT_tutor2_3.*
      :width: 500 px
   :align: center

现在添加的psxy命令和刚才的差别是没有了-S和-G选项，这是因为画线条不是画图形，-S是指定图形的，线条也不需要填充。两个>之间的经纬度表示一条线条的两个端点。

pstext模块添加文字
---------
我们需要往图画里添加台站所在地区的名字。添加文字使用pstext模块。

.. literalinclude:: ../scripts/GMT_tutor2_4.sh
         :language: bash
   :lines: 2


.. figure:: /images/GMT_tutor2_4.*
         :width: 500 px
   :align: center

解释如下：

1. EOF之间的每一行依次是加入的文本的纬度、经度和内容，这与psxy类似，只是因为有内容，所以多了一列。之所以没有写在一个gmt pstext命令之下，是因为图形位置不同需要有些许不同的调整，你可以看到每个pstext命令的-D参数些许不同，下面会详细解释。

2. -F控制文本的字体、对齐方式等属性；+f是字体，10p,1,black表示大小为10p，1号字体，黑色；+j是控制文本的对齐方式，TL是是说EOF之间的经纬度坐标是文字区域这个块的左上角，L指左，T指上，LT和TL的含义完全一样。

3. -D是在上述坐标的基础上微调。-D-1.5c/-0.15c是说向左移动1.5厘米，向下移动0.15厘米。
