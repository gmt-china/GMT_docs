绘制震源球
==========

:doc:`/module/psmeca` 模块可以用于绘制震源机制解。

绘制震源机制解就要向 GMT 提供震源的信息：震源机制解、震源位置、沙滩球位置和震级等等。
其中，震源机制解本身有多种描述方法，需要告诉 GMT 使用的是究竟哪种描述方式。
:doc:`/module/psmeca` 模块用 ``-S`` 选项决定震源球的描述方式，支持的描述方式有五种：

#. Aki-Richards 描述
#. Harvard CMT
#. GCMT 零迹矩张量
#. 两个断层平面的部分参数
#. T、N、P轴

具体请见模块手册。

在告知 GMT 震源机制解的描述方法后，就要根据相应的描述方法，向 GMT 输入相应的数据。

绘制单个震源球
--------------

.. gmt-plot:: beachball_1.sh

震源球大小随震级变化
--------------------

删除参数 ``-M``\ ，即可实现震源球大小随震级变化。
``-Sa1c`` 的 ``1c`` 就是指明 5 级地震的大小为 ``1c``\ 。
其他地震的大小按照如下公式计算::

        size = M / 5 * <scale>

.. gmt-plot:: beachball_2.sh

震源球大小随震级变化，颜色随深度变化
------------------------------------

现在用压缩区的颜色表示震源的深度。
先生成一个 cpt 文件，为每个深度段设置不同的颜色。
然后，使用 :doc:`/module/psmeca` 模块的时候用 ``-Z`` 参数调用即可。

.. gmt-plot:: beachball_3.sh
