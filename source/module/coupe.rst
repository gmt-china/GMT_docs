.. index:: ! coupe
.. include:: common_SYN_OPTs.rst_

coupe
=====

:官方文档: :doc:`gmt:supplements/seis/coupe`
:简介: 绘制震源机制解的剖面图

:doc:`meca` 在绘制震源球时，本质上是取了一个水平剖面，并将三维震源球的下半球投影到该水平剖面上。
而 :doc:`coupe` 则更灵活一些，可以将三维震源球投影到任意一个剖面上（例如垂直平面）。

- 对于一个水平剖面，会将下半球投影到平面上（即 :doc:`meca` 的做法）
- 对于一个垂直剖面，会将垂直平面 **后方** 的半球投影到平面上
- 对于任意一个非水平的平面而言：

  - u方向为平面的最速下降方向
  - s方向为平面的走向方向

输入数据中定义在 r, t, f 座标系中的矩张量会被重新定义到新的 -u^s, -u, s 座标系中。
在实际绘图中，通常使用 **-JX15c/-5c** 这样的投影参数定义一个Y轴正方向向下的笛卡尔座标系进行绘图。
三维震源球投影在这个笛卡尔座标系中的X座标为s方向上相对于剖面起点的距离，单位km。
而Y座标为u方向上相对于剖面起点的距离，单位km。对于一个垂直剖面，Y座标即为深度。

语法
----

**gmt coupe**
[ *table* ]
|-J|\ *parameters*
|SYN_OPT-R|
|-A|\ **a**\|\ **b**\|\ **c**\|\ **d**\ *params*\ [**+c**\ [**n**\|\ **t**]][**+d**\ *dip*][**+r**\ [**a**\|\ **e**\|\ *dx*]][**+w**\ *width*][**+z**\ [**s**]\ **a**\|\ **e**\|\ *dz*\|\ *min*/*max*]
|-S|\ *format*\ [*scale*][**+a**\ *angle*][**+f**\ *font*][**+j**\ *justify*][**+l**][**+m**][**+o**\ *dx*\ [/*dy*]][**+s**\ *reference*]
[ |SYN_OPT-B| ]
[ |-C|\ *cpt* ]
[ |-D|\ [**+c**][**+g**\ [*fill*]][**+o**\ *dx*\ [/*dy*]][**+p**\ *pen*][**+s**\ [*symbol*]\ *size*] ]
[ |-E|\ *fill* ]
[ |-F|\ *mode*\ [*args*] ]
[ |-G|\ *fill* ]
[ |-H|\ [*scale*] ]
[ |-I|\ [*intens*] ]
[ |-L|\ [*pen*] ]
[ |-N| ]
[ |-Q| ]
[ |-T|\ [*plane*]\ [**+p**\ *pen*] ]
[ |SYN_OPT-U| ]
[ |SYN_OPT-V| ]
[ |-W|\ *pen* ]
[ |SYN_OPT-X| ]
[ |SYN_OPT-Y| ]
[ |SYN_OPT-di| ]
[ |SYN_OPT-e| ]
[ |SYN_OPT-h| ]
[ |SYN_OPT-i| ]
[ |SYN_OPT-p| ]
[ |SYN_OPT-qi| ]
[ |SYN_OPT-tv| ]
[ |SYN_OPT-:| ]
[ |SYN_OPT--| ]

必须选项
--------

.. include:: explain_intables.rst_

.. include:: explain_-J.rst_

.. include:: explain_-R.rst_

.. _-A:

**-Aa**\|\ **b**\|\ **c**\|\ **d**\ *params*\ [**+d**\ *dip*][**+r**\ [**a**\|\ **e**\|\ *dx*]][**+w**\ *width*]
    以多种方式指定剖面

**-Aa**\ *lon1*/*lat1*/*lon2*/*lat2*

    - *lon1/lat1* 剖面起点的经纬度
    - *lon2/lat2* 剖面终点的经纬度
    - *dip* 剖面所在平面的倾角。0表示水平剖面，90表示垂直剖面。默认为90度垂直剖面。
    - *width* 剖面两侧每一侧的宽度范围，单位为km（即剖面不是一个平面，而是一个有厚度的长方体）。宽度范围以外的数据点会被剔除。注意单位固定为km不可更改。默认为无限宽度，即囊括剖面两侧所有的数据点。
    - **+r** 自动计算作图范围，不需要再设置 |-R| 。在后面附加 **a** 会对作图范围自动进行四舍五入。附加 **e** 则表示进行精确计算（默认）。也可以附加一个数值 *dx* ，表示四舍五入到 *dx* 的整数倍。

**-Ab**\ *lon1*/*lat1*/*strike*/*length*

    - *lon1/lat1* 剖面起点的经纬度
    - *strike* 是剖面的走向的方位角
    - *length* 是剖面的长度，单位固定为km不可更改。
    - 其他参数与 **-Aa** 相同

**-Ac**\ *x1*/*y1*/*x2*/*y2*

    与 **-Aa** 选项相同，只是 *x/y* 为笛卡尔坐标而不是地理坐标

**-Ad**\ *x1*/*y1*/*strike*/*length*
    与 **-Ab** 选项相同，只是 *x/y* 为笛卡尔坐标而不是地理坐标

.. _-S:

.. include:: explain_meca_-S.rst_

可选选项
--------

.. include:: explain_-B.rst_

.. _-C:

**-C**\ *cpt*
    设置 CPT 根据数据文件中第三列的值（即地震深度）确定震源球的压缩部分的颜色。

.. _-E:

**-E**\ *fill*
    扩张部分的填充色 [默认为白色]

.. _-F:

**-F**\ *mode*\ [*args*]
    设置多个属性，可重复使用多次

**-Fs**\ *symbol*\ [*size*]
    不绘制震源球，仅绘制一个符号。

    *symbol* 为符号类型，可以选择 **c**\|\ **d**\|\ **i**\|\ **s**\|\ **t**\|\ **x**，
    符号的具体含义见 :doc:`plot` 模块的 |-S| 选项。*size* 为符号大小，后面可以附加单位 **c**, **i** 或 **p** 。

    输入数据的格式为::

        longitude latitude depth [event_label]

    若未指定 *size*，则需要从输入数据的第四列读入符号大小，其余列向后移动。 *event_label* 为字符串标签的文本。

**-Fa**\ [*size*\ [/*Psymbol*\ [*Tsymbol*]]]
    计算并在震源球上P轴和T轴处绘制符号。
    *size* 是符号大小；
    *Psymbol* 和 *Tsymbol* 符号可以取 **c**\|\ **d**\|\ **h**\|\ **i**\|\ **p**\|\ **s**\|\ **t**\|\ **x**，
    具体含义见 :doc:`plot` |-S| 选项 [默认值为 6\ **p**/**cc**]

**-Fe**\ *fill*
    设置T轴符号的填充色。默认为 |-E| 控制。

**-Fg**\ *fill*
    设置P轴符号的填充色。默认为 |-G| 控制。

**-Fp**\ [*pen*]
    绘制P轴符号的轮廓。如果不设置画笔属性 *pen* 则默认为 |-W| 控制。

**-Ft**\ [*pen*]
    绘制T轴符号的轮廓。如果不设置画笔属性 *pen* 则默认为 |-W| 控制。

**-Fr**\ [*fill*]
    在震源球标签后加一个方框 [默认填充色为白色]

.. _-G:

**-G**\ *fill*
    指定压缩部分的填充色 [默认为黑色]

.. _-L:

**-L**\ [*pen*]
    绘制震源球外部轮廓。如果不设置画笔属性 *pen* 则默认为 |-W| 控制。

.. _-N:

**-N**
    绘图区域外的震源球也要绘制，默认不绘制。

.. _-Q:

**-Q**
    默认会生成一些临时文件，其中包含了剖面和剖面上的震源机制的信息，
    供调试时使用。使用该选项，则不会生成这些临时文件。

.. _-T:

**-T**\ [*plane*]\ [**+p**\ *pen*]
    绘制断层平面。

    *plane* 可以取：

    - *0* 绘制两个断层面
    - *1* 绘制第一个断层面
    - *2* 绘制第二个断层面

    可以添加 **+p**\ *pen* 设置画笔属性。如果不设置画笔属性则默认为 |-W| 控制。

    对于双力偶机制解而言，|-T| 选项只绘制震源球的圆周和断层平面，不填充颜色；
    对于非双力偶机制解而言，**-T**\ *0* 在震源球的基础上覆盖上透明的断层平面。

.. _-W:

**-W**\ [*pen*]
    设置断层平面的画笔属性 [默认为 0.25p,black,solid]

示例
----

从文本文件 data.txt 中读取数据，只挑选垂直剖面两侧4km的数据点绘图，自动计算作图范围。示例数据下载：:download:`coupe/data.txt`

.. gmtplot:: coupe/coupe_ex1.sh
   :width: 80%

相关模块
--------

:doc:`meca`,
:doc:`polar`,
:doc:`basemap`,
:doc:`plot`
